{"Error":[{"errorId":"E_CSC_USER_INVALIDEXPRESSIONSYNTAX","severity":"Error","component":"CSC","source":"User","message":"Invalid expression: '\r\n               ROW_NUMBER() OVER(PARTITION BY\r\n               id.ToLower(),\r\n               data_channels_live,\r\n               source_FolderFile,\r\n               ORDER BY load_date DESC)'. Argument missing","description":"The expression does not conform to the expression syntax.","resolution":"Make sure the expression uses correct expression syntax.","details":"at token ',', line 31\r\nnear the ###:\r\n**************\r\n   load_date,\r\n               ROW_NUMBER() OVER(PARTITION BY\r\n               id.ToLower(),\r\n               data_channels_live,\r\n               source_FolderFile ### ,\r\n               ORDER BY load_date DESC) AS rn_truerecords\r\n        FROM LG_DW_LGP.std.mstr_programversions;\r\n\r\n    @Programversions =\r\n        SELECT *\r\n    ","internalDiagnostics":"   at ScopeCompiler.FrontEnd.ExpressionHelper.ConvertRoslynParserErrors(Script script, Compiler compiler, IKeywordTable keywords, Expression expr, IRoslynTree syntaxTree, DiagnosticCollection diagnostics)\r\n   at ScopeCompiler.FrontEnd.ExpressionHelper.Verify(Script script, VariableBinding variableBinding, Compiler compiler, IKeywordTable keywords, Expression e, DiagnosticCollection diagnostics)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.OnExpression(Script currentScript, Expression e)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.TreeVisitor`2.Visit(P input, IEnumerable`1 nodes)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.TreeVisitor`2.Visit(P input, IEnumerable`1 nodes)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.OnSelectQuery(Script input, SelectQuery e)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.TreeVisitor`2.Visit(P input, IEnumerable`1 nodes)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.OnQueryStatement(Script input, QueryStatement e)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.TreeVisitor`2.Visit(P input, IEnumerable`1 nodes)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.OnBatch(Script input, Batch e)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.Resolve()\r\n   at ScopeCompiler.FrontEnd.CompilePassHelper.Run(Action pass, Compiler compiler, CompilerTimer timer, Boolean throwOnErrors)\r\n   at ScopeCompiler.FrontEnd.SqlAstBuilder.BuildAst(Compiler compiler, FunctionCall parentCall, NameContext nameContext, SubroutineType subroutineType, Script parent, DiagnosticCollection diagnostics, Script[] legacyScripts)\r\n   at ScopeCompiler.FrontEnd.SqlAstBuilder.BuildAst(Script[] scripts)\r\n   at ScopeCompiler.FrontEnd.SqlCompileStrategy.<>c__DisplayClass7_0.<AstBuildingPass>b__1()\r\n   at ScopeCompiler.FrontEnd.CompilePassHelper.Run(Action pass, Compiler compiler, CompilerTimer timer, Boolean throwOnErrors)\r\n   at ScopeCompiler.FrontEnd.FrontEndRunner.Execute()\r\n   at ScopeCompiler.FrontEnd.CompilePipeline.DoExecutePipeline()\r\n   at ScopeCompiler.FrontEnd.CompilePipeline.DoCompile()\r\n   at ScopeCompiler.FrontEnd.CompilePipeline.CreateContextAndCompile()\r\n   at ScopeCompiler.FrontEnd.CompilePipeline.Execute()\r\n   at Microsoft.Analytics.LocalRun.LocalParseSandboxer.PrivateParse(String script, Settings settings)\r\n   at System.Runtime.Remoting.Messaging.StackBuilderSink._PrivateProcessMessage(IntPtr md, Object[] args, Object server, Object[]& outArgs)\r\n   at System.Runtime.Remoting.Messaging.StackBuilderSink.SyncProcessMessage(IMessage msg)\r\n   at System.Runtime.Remoting.Messaging.ServerObjectTerminatorSink.SyncProcessMessage(IMessage reqMsg)\r\n   at System.Runtime.Remoting.Messaging.ServerContextTerminatorSink.SyncProcessMessage(IMessage reqMsg)\r\n   at System.Runtime.Remoting.Channels.CrossContextChannel.SyncProcessMessageCallback(Object[] args)\r\n   at System.Threading.Thread.InternalCrossContextCallback(Context ctx, IntPtr ctxID, Int32 appDomainID, InternalCrossContextDelegate ftnToCall, Object[] args)\r\n   at System.Runtime.Remoting.Channels.CrossContextChannel.SyncProcessMessage(IMessage reqMsg)\r\n   at System.Runtime.Remoting.Channels.ChannelServices.SyncDispatchMessage(IMessage msg)\r\n   at System.Runtime.Remoting.Channels.CrossAppDomainSink.DoDispatch(Byte[] reqStmBuff, SmuggledMethodCallMessage smuggledMcm, SmuggledMethodReturnMessage& smuggledMrm)\r\n   at System.Runtime.Remoting.Channels.CrossAppDomainSink.DoTransitionDispatchCallback(Object[] args)\r\n","helpLink":"","filePath":null,"lineNumber":31,"startOffset":1192,"endOffset":1193},{"errorId":"E_CSC_USER_DDLENTITYDOESNOTEXIST","severity":"Error","component":"CSC","source":"User","message":"Database 'LG_DW_LGP' does not exist.","description":"No entity of the required type has the specified name.","resolution":"Either check that the name is correct or create an entity with the specified name.","details":"at token 'LG_DW_LGP', line 33\r\nnear the ###:\r\n**************\r\n  id.ToLower(),\r\n               data_channels_live,\r\n               source_FolderFile,\r\n               ORDER BY load_date DESC) AS rn_truerecords\r\n        FROM  ### LG_DW_LGP.std.mstr_programversions;\r\n\r\n    @Programversions =\r\n        SELECT *\r\n        FROM @QUERY_DISTINCT_PROGRAMVERSIONS\r\n        WHERE rn_truerecords == 1","internalDiagnostics":"   at ScopeCompiler.CompilerDiagnostic.CreateInternal(DiagnosticCode code, Token anchor, Boolean pastTokenEnd, Script script, Object[] args)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.CheckExiststence[T](Script script, DdlName name, Token token, Boolean ifExists)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.CheckAncestorsExist(Script script, DdlName name, Token token)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.OnTableReference(Script input, TableReference e)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.TreeVisitor`2.Visit(P input, IEnumerable`1 nodes)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.TreeVisitor`2.Visit(P input, IEnumerable`1 nodes)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.TreeVisitor`2.Visit(P input, IEnumerable`1 nodes)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.OnSelectQuery(Script input, SelectQuery e)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.TreeVisitor`2.Visit(P input, IEnumerable`1 nodes)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.OnQueryStatement(Script input, QueryStatement e)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.TreeVisitor`2.Visit(P input, IEnumerable`1 nodes)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.OnBatch(Script input, Batch e)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.Resolve()\r\n   at ScopeCompiler.FrontEnd.CompilePassHelper.Run(Action pass, Compiler compiler, CompilerTimer timer, Boolean throwOnErrors)\r\n   at ScopeCompiler.FrontEnd.SqlAstBuilder.BuildAst(Compiler compiler, FunctionCall parentCall, NameContext nameContext, SubroutineType subroutineType, Script parent, DiagnosticCollection diagnostics, Script[] legacyScripts)\r\n   at ScopeCompiler.FrontEnd.SqlAstBuilder.BuildAst(Script[] scripts)\r\n   at ScopeCompiler.FrontEnd.SqlCompileStrategy.<>c__DisplayClass7_0.<AstBuildingPass>b__1()\r\n   at ScopeCompiler.FrontEnd.CompilePassHelper.Run(Action pass, Compiler compiler, CompilerTimer timer, Boolean throwOnErrors)\r\n   at ScopeCompiler.FrontEnd.FrontEndRunner.Execute()\r\n   at ScopeCompiler.FrontEnd.CompilePipeline.DoExecutePipeline()\r\n   at ScopeCompiler.FrontEnd.CompilePipeline.DoCompile()\r\n   at ScopeCompiler.FrontEnd.CompilePipeline.CreateContextAndCompile()\r\n   at ScopeCompiler.FrontEnd.CompilePipeline.Execute()\r\n   at Microsoft.Analytics.LocalRun.LocalParseSandboxer.PrivateParse(String script, Settings settings)\r\n   at System.Runtime.Remoting.Messaging.StackBuilderSink._PrivateProcessMessage(IntPtr md, Object[] args, Object server, Object[]& outArgs)\r\n   at System.Runtime.Remoting.Messaging.StackBuilderSink.SyncProcessMessage(IMessage msg)\r\n   at System.Runtime.Remoting.Messaging.ServerObjectTerminatorSink.SyncProcessMessage(IMessage reqMsg)\r\n   at System.Runtime.Remoting.Messaging.ServerContextTerminatorSink.SyncProcessMessage(IMessage reqMsg)\r\n   at System.Runtime.Remoting.Channels.CrossContextChannel.SyncProcessMessageCallback(Object[] args)\r\n   at System.Threading.Thread.InternalCrossContextCallback(Context ctx, IntPtr ctxID, Int32 appDomainID, InternalCrossContextDelegate ftnToCall, Object[] args)\r\n   at System.Runtime.Remoting.Channels.CrossContextChannel.SyncProcessMessage(IMessage reqMsg)\r\n   at System.Runtime.Remoting.Channels.ChannelServices.SyncDispatchMessage(IMessage msg)\r\n   at System.Runtime.Remoting.Channels.CrossAppDomainSink.DoDispatch(Byte[] reqStmBuff, SmuggledMethodCallMessage smuggledMcm, SmuggledMethodReturnMessage& smuggledMrm)\r\n   at System.Runtime.Remoting.Channels.CrossAppDomainSink.DoTransitionDispatchCallback(Object[] args)\r\n","helpLink":"","filePath":null,"lineNumber":33,"startOffset":1267,"endOffset":1276},{"errorId":"E_CSC_USER_DDLENTITYDOESNOTEXIST","severity":"Error","component":"CSC","source":"User","message":"Database 'LG_DM_LGP' does not exist.","description":"No entity of the required type has the specified name.","resolution":"Either check that the name is correct or create an entity with the specified name.","details":"at token 'DROP', line 133\r\nnear the ###:\r\n**************\r\nateTime?) createdTimestamp,\r\n               insertedTimestamp,\r\n               expiredTimestamp,\r\n               isActiveRecord\r\n        FROM @Defaults;\r\n\r\n     ### DROP TABLE IF EXISTS LG_DM_LGP.cur.dim_programversion;\r\n    CREATE TABLE IF NOT EXISTS LG_DM_LGP.cur.dim_programversion\r\n    (\r\n        INDEX clx_name\r\n        ","internalDiagnostics":"   at ScopeCompiler.CompilerDiagnostic.CreateInternal(DiagnosticCode code, Token anchor, Boolean pastTokenEnd, Script script, Object[] args)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.CheckExiststence[T](Script script, DdlName name, Token token, Boolean ifExists)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.CheckAncestorsExist(Script script, DdlName name, Token token)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.OnDropTableStatement(Script input, DropTableStatement e)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.TreeVisitor`2.Visit(P input, IEnumerable`1 nodes)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.OnBatch(Script input, Batch e)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.Resolve()\r\n   at ScopeCompiler.FrontEnd.CompilePassHelper.Run(Action pass, Compiler compiler, CompilerTimer timer, Boolean throwOnErrors)\r\n   at ScopeCompiler.FrontEnd.SqlAstBuilder.BuildAst(Compiler compiler, FunctionCall parentCall, NameContext nameContext, SubroutineType subroutineType, Script parent, DiagnosticCollection diagnostics, Script[] legacyScripts)\r\n   at ScopeCompiler.FrontEnd.SqlAstBuilder.BuildAst(Script[] scripts)\r\n   at ScopeCompiler.FrontEnd.SqlCompileStrategy.<>c__DisplayClass7_0.<AstBuildingPass>b__1()\r\n   at ScopeCompiler.FrontEnd.CompilePassHelper.Run(Action pass, Compiler compiler, CompilerTimer timer, Boolean throwOnErrors)\r\n   at ScopeCompiler.FrontEnd.FrontEndRunner.Execute()\r\n   at ScopeCompiler.FrontEnd.CompilePipeline.DoExecutePipeline()\r\n   at ScopeCompiler.FrontEnd.CompilePipeline.DoCompile()\r\n   at ScopeCompiler.FrontEnd.CompilePipeline.CreateContextAndCompile()\r\n   at ScopeCompiler.FrontEnd.CompilePipeline.Execute()\r\n   at Microsoft.Analytics.LocalRun.LocalParseSandboxer.PrivateParse(String script, Settings settings)\r\n   at System.Runtime.Remoting.Messaging.StackBuilderSink._PrivateProcessMessage(IntPtr md, Object[] args, Object server, Object[]& outArgs)\r\n   at System.Runtime.Remoting.Messaging.StackBuilderSink.SyncProcessMessage(IMessage msg)\r\n   at System.Runtime.Remoting.Messaging.ServerObjectTerminatorSink.SyncProcessMessage(IMessage reqMsg)\r\n   at System.Runtime.Remoting.Messaging.ServerContextTerminatorSink.SyncProcessMessage(IMessage reqMsg)\r\n   at System.Runtime.Remoting.Channels.CrossContextChannel.SyncProcessMessageCallback(Object[] args)\r\n   at System.Threading.Thread.InternalCrossContextCallback(Context ctx, IntPtr ctxID, Int32 appDomainID, InternalCrossContextDelegate ftnToCall, Object[] args)\r\n   at System.Runtime.Remoting.Channels.CrossContextChannel.SyncProcessMessage(IMessage reqMsg)\r\n   at System.Runtime.Remoting.Channels.ChannelServices.SyncDispatchMessage(IMessage msg)\r\n   at System.Runtime.Remoting.Channels.CrossAppDomainSink.DoDispatch(Byte[] reqStmBuff, SmuggledMethodCallMessage smuggledMcm, SmuggledMethodReturnMessage& smuggledMrm)\r\n   at System.Runtime.Remoting.Channels.CrossAppDomainSink.DoTransitionDispatchCallback(Object[] args)\r\n","helpLink":"","filePath":null,"lineNumber":133,"startOffset":4276,"endOffset":4280},{"errorId":"E_CSC_USER_DDLENTITYDOESNOTEXIST","severity":"Error","component":"CSC","source":"User","message":"Database 'LG_DM_LGP' does not exist.","description":"No entity of the required type has the specified name.","resolution":"Either check that the name is correct or create an entity with the specified name.","details":"at token 'LG_DM_LGP', line 134\r\nnear the ###:\r\n**************\r\nimestamp,\r\n               isActiveRecord\r\n        FROM @Defaults;\r\n\r\n    DROP TABLE IF EXISTS LG_DM_LGP.cur.dim_programversion;\r\n    CREATE TABLE IF NOT EXISTS  ### LG_DM_LGP.cur.dim_programversion\r\n    (\r\n        INDEX clx_name\r\n        CLUSTERED(name ASC)\r\n        DISTRIBUTED BY\r\n        HASH(name)\r\n    )\r\n\tAS\r\n    SELECT","internalDiagnostics":"   at ScopeCompiler.CompilerDiagnostic.CreateInternal(DiagnosticCode code, Token anchor, Boolean pastTokenEnd, Script script, Object[] args)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.CheckExiststence[T](Script script, DdlName name, Token token, Boolean ifExists)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.CheckAncestorsExist(Script script, DdlName name, Token token)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.CheckExistenceForCreate[T](Script script, DdlName name, Token token, Boolean ifNotExists)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.OnCreateTableStatement(Script input, CreateTableStatement e)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.TreeVisitor`2.Visit(P input, IEnumerable`1 nodes)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.OnBatch(Script input, Batch e)\r\n   at ScopeCompiler.VisitorContext`1.Visit(T node, Action accept)\r\n   at ScopeCompiler.FrontEnd.Ddl.SqlDdlResolver.Resolve()\r\n   at ScopeCompiler.FrontEnd.CompilePassHelper.Run(Action pass, Compiler compiler, CompilerTimer timer, Boolean throwOnErrors)\r\n   at ScopeCompiler.FrontEnd.SqlAstBuilder.BuildAst(Compiler compiler, FunctionCall parentCall, NameContext nameContext, SubroutineType subroutineType, Script parent, DiagnosticCollection diagnostics, Script[] legacyScripts)\r\n   at ScopeCompiler.FrontEnd.SqlAstBuilder.BuildAst(Script[] scripts)\r\n   at ScopeCompiler.FrontEnd.SqlCompileStrategy.<>c__DisplayClass7_0.<AstBuildingPass>b__1()\r\n   at ScopeCompiler.FrontEnd.CompilePassHelper.Run(Action pass, Compiler compiler, CompilerTimer timer, Boolean throwOnErrors)\r\n   at ScopeCompiler.FrontEnd.FrontEndRunner.Execute()\r\n   at ScopeCompiler.FrontEnd.CompilePipeline.DoExecutePipeline()\r\n   at ScopeCompiler.FrontEnd.CompilePipeline.DoCompile()\r\n   at ScopeCompiler.FrontEnd.CompilePipeline.CreateContextAndCompile()\r\n   at ScopeCompiler.FrontEnd.CompilePipeline.Execute()\r\n   at Microsoft.Analytics.LocalRun.LocalParseSandboxer.PrivateParse(String script, Settings settings)\r\n   at System.Runtime.Remoting.Messaging.StackBuilderSink._PrivateProcessMessage(IntPtr md, Object[] args, Object server, Object[]& outArgs)\r\n   at System.Runtime.Remoting.Messaging.StackBuilderSink.SyncProcessMessage(IMessage msg)\r\n   at System.Runtime.Remoting.Messaging.ServerObjectTerminatorSink.SyncProcessMessage(IMessage reqMsg)\r\n   at System.Runtime.Remoting.Messaging.ServerContextTerminatorSink.SyncProcessMessage(IMessage reqMsg)\r\n   at System.Runtime.Remoting.Channels.CrossContextChannel.SyncProcessMessageCallback(Object[] args)\r\n   at System.Threading.Thread.InternalCrossContextCallback(Context ctx, IntPtr ctxID, Int32 appDomainID, InternalCrossContextDelegate ftnToCall, Object[] args)\r\n   at System.Runtime.Remoting.Channels.CrossContextChannel.SyncProcessMessage(IMessage reqMsg)\r\n   at System.Runtime.Remoting.Channels.ChannelServices.SyncDispatchMessage(IMessage msg)\r\n   at System.Runtime.Remoting.Channels.CrossAppDomainSink.DoDispatch(Byte[] reqStmBuff, SmuggledMethodCallMessage smuggledMcm, SmuggledMethodReturnMessage& smuggledMrm)\r\n   at System.Runtime.Remoting.Channels.CrossAppDomainSink.DoTransitionDispatchCallback(Object[] args)\r\n","helpLink":"","filePath":null,"lineNumber":134,"startOffset":4363,"endOffset":4372}]}